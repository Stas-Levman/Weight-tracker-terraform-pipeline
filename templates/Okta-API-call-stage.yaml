steps:
- script: |
    ip_address="$(az network public-ip show -g weight-tracker-$(Environment.Name)-rg -n front-public-ip --query "ipAddress")"
    curl -v -X PUT \
    -H "Accept: application/json" \
    -H "Content-Type: application/json" \
    -H "Authorization: SSWS $(OKTA-api-token)" \
    -d '{
      "client_id": "$(OKTA-client-ID-stage)",
      "client_name": "$(OKTA-client-name-stage)",
      "client_uri": "",
      "logo_uri": "",
      "application_type": "web",
      "redirect_uris": [
        "http://'${echo $ip_address}':8080/authorization-code/callback"
      ],
      "post_logout_redirect_uris": [
        "http://'${echo $ip_address}':8080/logout"
      ],
      "response_types": [
        "id_token",
        "code"
      ],
      "grant_types": [
        "authorization_code",
        "implicit"
      ],
      "token_endpoint_auth_method": "client_secret_post",
      "initiate_login_uri": ""
    }' "https://dev-77800982.okta.com/oauth2/v1/clients/$(OKTA-client-ID-stage)"
  displayName: Update Okta URLs via API

